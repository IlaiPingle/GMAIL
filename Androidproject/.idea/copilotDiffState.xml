<?xml version="1.0" encoding="UTF-8"?>
<project version="4">
  <component name="CopilotDiffPersistence">
    <option name="pendingDiffs">
      <map>
        <entry key="$PROJECT_DIR$/app/src/main/java/com/example/androidproject/HomeActivity.java">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/app/src/main/java/com/example/androidproject/HomeActivity.java" />
              <option name="originalContent" value="package com.example.androidproject;&#10;&#10;import android.content.Intent;&#10;import android.graphics.Canvas;&#10;import android.graphics.Color;&#10;import android.graphics.Paint;&#10;import android.os.Bundle;&#10;import android.view.MenuItem;&#10;import android.view.View;&#10;import android.widget.Toast;&#10;import androidx.activity.OnBackPressedCallback;&#10;import androidx.annotation.NonNull;&#10;import androidx.appcompat.app.ActionBarDrawerToggle;&#10;import androidx.appcompat.app.AppCompatActivity;&#10;import androidx.appcompat.widget.SearchView;&#10;import androidx.appcompat.widget.Toolbar;&#10;import androidx.core.view.GravityCompat;&#10;import androidx.drawerlayout.widget.DrawerLayout;&#10;import androidx.recyclerview.widget.ItemTouchHelper;&#10;import androidx.recyclerview.widget.LinearLayoutManager;&#10;import androidx.recyclerview.widget.RecyclerView;&#10;import androidx.swiperefreshlayout.widget.SwipeRefreshLayout;&#10;import com.google.android.material.floatingactionbutton.FloatingActionButton;&#10;import com.google.android.material.navigation.NavigationView;&#10;import com.google.android.material.snackbar.Snackbar;&#10;import com.google.android.material.tabs.TabLayout;&#10;import java.util.ArrayList;&#10;import java.util.List;&#10;import com.example.androidproject.EmailApiService;&#10;import com.example.androidproject.model.EmailData;&#10;import com.example.androidproject.ui.email.EmailAdapter;&#10;import com.example.androidproject.model.EmailItem;&#10;import com.example.androidproject.ApiClient;&#10;import retrofit2.Call;&#10;import retrofit2.Callback;&#10;import retrofit2.Response;&#10;&#10;/**&#10; * HomeActivity displays a list of emails with functionalities like search, refresh, and compose.&#10; */&#10;public class HomeActivity extends AppCompatActivity implements&#10;        EmailAdapter.OnEmailClickListener,&#10;        NavigationView.OnNavigationItemSelectedListener {&#10;&#10;    private DrawerLayout drawerLayout;&#10;    private RecyclerView recyclerView;&#10;    private EmailAdapter adapter;&#10;    private SwipeRefreshLayout swipeRefreshLayout;&#10;    private final List&lt;EmailItem&gt; emailList = new ArrayList&lt;&gt;();&#10;    private TabLayout tabLayout;&#10;    private boolean isLoading = false;&#10;&#10;    @Override&#10;    protected void onCreate(Bundle savedInstanceState) {&#10;        super.onCreate(savedInstanceState);&#10;        setContentView(R.layout.activity_home);&#10;&#10;        // Setup toolbar&#10;        Toolbar toolbar = findViewById(R.id.toolbar);&#10;        setSupportActionBar(toolbar);&#10;        if (getSupportActionBar() != null) {&#10;            getSupportActionBar().setDisplayShowTitleEnabled(false);&#10;        }&#10;&#10;        // Setup navigation drawer&#10;        drawerLayout = findViewById(R.id.drawerLayout);&#10;        NavigationView navigationView = findViewById(R.id.navigationView);&#10;        navigationView.setNavigationItemSelectedListener(this);&#10;        ActionBarDrawerToggle toggle = new ActionBarDrawerToggle(&#10;                this, drawerLayout, toolbar, R.string.navigation_drawer_open, R.string.navigation_drawer_close);&#10;        drawerLayout.addDrawerListener(toggle);&#10;        toggle.syncState();&#10;&#10;        // Back gesture handling (closes drawer first)&#10;        getOnBackPressedDispatcher().addCallback(this, new OnBackPressedCallback(true) {&#10;            @Override public void handleOnBackPressed() {&#10;                if (drawerLayout.isDrawerOpen(GravityCompat.START)) {&#10;                    drawerLayout.closeDrawer(GravityCompat.START);&#10;                } else {&#10;                    setEnabled(false);&#10;                    getOnBackPressedDispatcher().onBackPressed();&#10;                }&#10;            }&#10;        });&#10;&#10;        // Setup tabs&#10;        tabLayout = findViewById(R.id.tabLayout);&#10;        tabLayout.addTab(tabLayout.newTab().setText(&quot;Primary&quot;));&#10;        tabLayout.addTab(tabLayout.newTab().setText(&quot;Social&quot;));&#10;        tabLayout.addTab(tabLayout.newTab().setText(&quot;Promotions&quot;));&#10;&#10;        // Setup RecyclerView&#10;        recyclerView = findViewById(R.id.recyclerViewEmails);&#10;        recyclerView.setLayoutManager(new LinearLayoutManager(this));&#10;&#10;        // Setup adapter&#10;        adapter = new EmailAdapter(emailList, this);&#10;        recyclerView.setAdapter(adapter);&#10;&#10;        // Setup SwipeRefreshLayout&#10;        swipeRefreshLayout = findViewById(R.id.swipeRefreshLayout);&#10;        swipeRefreshLayout.setColorSchemeResources(android.R.color.holo_blue_bright,&#10;                android.R.color.holo_green_light,&#10;                android.R.color.holo_orange_light,&#10;                android.R.color.holo_red_light);&#10;        swipeRefreshLayout.setOnRefreshListener(this::refreshEmails);&#10;&#10;        // Load emails from API&#10;        fetchEmailsFromApi();&#10;&#10;        // Setup swipe actions&#10;        setupSwipeActions();&#10;&#10;&#10;        // Setup FAB&#10;        FloatingActionButton fab = findViewById(R.id.fabCompose);&#10;        fab.setOnClickListener(v -&gt; {&#10;            Toast.makeText(this, &quot;Compose new email&quot;, Toast.LENGTH_SHORT).show();&#10;            // Launch compose activity&#10;        });&#10;&#10;        // Setup SearchView&#10;        SearchView searchView = findViewById(R.id.searchView);&#10;        searchView.setOnQueryTextListener(new SearchView.OnQueryTextListener() {&#10;            @Override&#10;            public boolean onQueryTextSubmit(String query) {&#10;                return false;&#10;            }&#10;&#10;            @Override&#10;            public boolean onQueryTextChange(String newText) {&#10;                adapter.getFilter().filter(newText);&#10;                return true;&#10;            }&#10;        });&#10;    }&#10;&#10;    /**&#10;     * Setup swipe actions for RecyclerView items (archive and delete).&#10;     */&#10;    private void setupSwipeActions() {&#10;        ItemTouchHelper.SimpleCallback callback = new ItemTouchHelper.SimpleCallback(0,&#10;                ItemTouchHelper.LEFT | ItemTouchHelper.RIGHT) {&#10;&#10;            @Override&#10;            public boolean onMove(@NonNull RecyclerView recyclerView,&#10;                                  @NonNull RecyclerView.ViewHolder viewHolder,&#10;                                  @NonNull RecyclerView.ViewHolder target) {&#10;                return false;&#10;            }&#10;&#10;            @Override&#10;            public void onSwiped(@NonNull RecyclerView.ViewHolder viewHolder, int direction) {&#10;                int position = viewHolder.getAdapterPosition();&#10;                EmailItem deletedEmail = emailList.get(position);&#10;&#10;                emailList.remove(position);&#10;                adapter.notifyItemRemoved(position);&#10;&#10;                String action = (direction == ItemTouchHelper.RIGHT) ? &quot;archived&quot; : &quot;deleted&quot;;&#10;&#10;                Snackbar.make(recyclerView, &quot;Email &quot; + action, Snackbar.LENGTH_LONG)&#10;                        .setAction(&quot;UNDO&quot;, v -&gt; {&#10;                            emailList.add(position, deletedEmail);&#10;                            adapter.notifyItemInserted(position);&#10;                        }).show();&#10;            }&#10;&#10;            @Override&#10;            public void onChildDraw(@NonNull Canvas c, @NonNull RecyclerView rv,&#10;                                    @NonNull RecyclerView.ViewHolder vh,&#10;                                    float dX, float dY, int actionState, boolean isCurrentlyActive) {&#10;                View itemView = vh.itemView;&#10;                Paint paint = new Paint();&#10;                if (dX &gt; 0) {&#10;                    paint.setColor(Color.parseColor(&quot;#2E7D32&quot;)); // green for archive&#10;                    c.drawRect(itemView.getLeft(), itemView.getTop(),&#10;                            itemView.getLeft() + dX, itemView.getBottom(), paint);&#10;                } else if (dX &lt; 0) {&#10;                    paint.setColor(Color.parseColor(&quot;#C62828&quot;)); // red for delete&#10;                    c.drawRect(itemView.getRight() + dX, itemView.getTop(),&#10;                            itemView.getRight(), itemView.getBottom(), paint);&#10;                }&#10;                super.onChildDraw(c, rv, vh, dX, dY, actionState, isCurrentlyActive);&#10;            }&#10;        };&#10;        new ItemTouchHelper(callback).attachToRecyclerView(recyclerView);&#10;    }&#10;&#10;    /**&#10;     * Handle navigation item selection.&#10;     */&#10;    @Override&#10;    public boolean onNavigationItemSelected(@NonNull MenuItem item) {&#10;        int id = item.getItemId();&#10;&#10;        // Handle navigation item clicks&#10;        if (id == R.id.nav_all_inboxes) {&#10;            Toast.makeText(this, &quot;All inboxes&quot;, Toast.LENGTH_SHORT).show();&#10;        } else if (id == R.id.nav_inbox) {&#10;            Toast.makeText(this, &quot;Inbox&quot;, Toast.LENGTH_SHORT).show();&#10;        } else if (id == R.id.nav_starred) {&#10;            Toast.makeText(this, &quot;Starred&quot;, Toast.LENGTH_SHORT).show();&#10;        } else if (id == R.id.nav_snoozed) {&#10;            Toast.makeText(this, &quot;Snoozed&quot;, Toast.LENGTH_SHORT).show();&#10;        } else if (id == R.id.nav_sent) {&#10;            Toast.makeText(this, &quot;Sent&quot;, Toast.LENGTH_SHORT).show();&#10;        }&#10;&#10;        drawerLayout.closeDrawer(GravityCompat.START);&#10;        return true;&#10;    }&#10;&#10;    /**&#10;     * Fetch emails from the API and update the RecyclerView.&#10;     */&#10;    private void fetchEmailsFromApi() {&#10;        if (isLoading) return;&#10;        isLoading = true;&#10;        // Show loading indicator&#10;        if (swipeRefreshLayout != null) {&#10;            swipeRefreshLayout.setEnabled(false);&#10;            swipeRefreshLayout.post(() -&gt; swipeRefreshLayout.setRefreshing(true));&#10;        }&#10;&#10;        EmailApiService apiService = ApiClient.getClient().create(EmailApiService.class);&#10;        Call&lt;List&lt;EmailData&gt;&gt; call = apiService.getMails();&#10;        call.enqueue(new Callback&lt;List&lt;EmailData&gt;&gt;() {&#10;            @Override&#10;            public void onResponse(Call&lt;List&lt;EmailData&gt;&gt; call, Response&lt;List&lt;EmailData&gt;&gt; response) {&#10;                finishLoading();&#10;                if (response.isSuccessful() &amp;&amp; response.body() != null) {&#10;                    List&lt;EmailItem&gt; items = new ArrayList&lt;&gt;();&#10;                    for (EmailData email : response.body()) {&#10;                        items.add(email.toEmailItem());&#10;                    }&#10;                    // Update UI&#10;                    adapter.setItems(items);&#10;                    if (items.isEmpty()) {&#10;                        showInfo(&quot;No emails yet&quot;);&#10;                    }&#10;                } else {&#10;                    String serverMsg = &quot;&quot;;&#10;                    try {&#10;                        if (response.errorBody() != null) {&#10;                            serverMsg = response.errorBody().string();&#10;                        }&#10;                    } catch (Exception ignored) {}&#10;                    if (response.code() == 401) {&#10;                        showErrorWithRetry(&quot;Session expired. Please log in again.&quot;);&#10;                        // Here you would redirect to login activity&#10;                        return;&#10;                    }&#10;                    String msg = serverMsg.isEmpty()&#10;                            ? &quot;Failed to load emails (&quot; + response.code() + &quot;)&quot;&#10;                            : &quot;Failed to load emails: &quot; + serverMsg;&#10;                    showErrorWithRetry(msg);&#10;                }&#10;            }&#10;&#10;            @Override&#10;            public void onFailure(Call&lt;List&lt;EmailData&gt;&gt; call, Throwable t) {&#10;                finishLoading();&#10;                showErrorWithRetry(&quot;Network error: &quot; + t.getMessage());&#10;            }&#10;        });&#10;    }&#10;&#10;    private void finishLoading() {&#10;        isLoading = false;&#10;        if (swipeRefreshLayout != null) {&#10;            swipeRefreshLayout.setRefreshing(false);&#10;            swipeRefreshLayout.setEnabled(true);&#10;        }&#10;    }&#10;&#10;    /**&#10;     * Show an informational &quot;Snackbar&quot; message.&#10;     */&#10;    private void showErrorWithRetry(String message) {&#10;        Snackbar.make(recyclerView, message, Snackbar.LENGTH_INDEFINITE)&#10;                .setAction(&quot;RETRY&quot;, v -&gt; fetchEmailsFromApi())&#10;                .show();&#10;    }&#10;&#10;    /**&#10;     * Show an informational &quot;Snackbar&quot; message.&#10;     */&#10;    private void showInfo(String message) {&#10;        Snackbar.make(recyclerView, message, Snackbar.LENGTH_SHORT).show();&#10;    }&#10;&#10;    /**&#10;     * When refresh is triggered, fetch emails from the API.&#10;     */&#10;    private void refreshEmails() {&#10;        fetchEmailsFromApi();&#10;    }&#10;&#10;    /**&#10;     * Handle email item click to mark as read and open detail view.&#10;     */&#10;    @Override&#10;    public void onEmailClick(int position) {&#10;        EmailItem email = adapter.getItem(position);&#10;        email.setRead(true);&#10;        adapter.notifyItemChanged(position);&#10;&#10;        // Here you would launch the email detail activity&#10;        Toast.makeText(this, &quot;Email from: &quot; + email.getSender(), Toast.LENGTH_SHORT).show();&#10;    }&#10;}" />
              <option name="updatedContent" value="package com.example.androidproject;&#10;&#10;import android.content.Intent;&#10;import android.graphics.Canvas;&#10;import android.graphics.Color;&#10;import android.graphics.Paint;&#10;import android.os.Bundle;&#10;import android.view.MenuItem;&#10;import android.view.View;&#10;import android.widget.Toast;&#10;import androidx.activity.OnBackPressedCallback;&#10;import androidx.annotation.NonNull;&#10;import androidx.appcompat.app.ActionBarDrawerToggle;&#10;import androidx.appcompat.app.AppCompatActivity;&#10;import androidx.appcompat.widget.SearchView;&#10;import androidx.appcompat.widget.Toolbar;&#10;import androidx.core.view.GravityCompat;&#10;import androidx.drawerlayout.widget.DrawerLayout;&#10;import androidx.recyclerview.widget.ItemTouchHelper;&#10;import androidx.recyclerview.widget.LinearLayoutManager;&#10;import androidx.recyclerview.widget.RecyclerView;&#10;import androidx.swiperefreshlayout.widget.SwipeRefreshLayout;&#10;import com.google.android.material.floatingactionbutton.FloatingActionButton;&#10;import com.google.android.material.navigation.NavigationView;&#10;import com.google.android.material.snackbar.Snackbar;&#10;import com.google.android.material.tabs.TabLayout;&#10;import java.util.ArrayList;&#10;import java.util.List;&#10;import com.example.androidproject.EmailApiService;&#10;import com.example.androidproject.model.EmailData;&#10;import com.example.androidproject.ui.email.EmailAdapter;&#10;import com.example.androidproject.model.EmailItem;&#10;import com.example.androidproject.ApiClient;&#10;import retrofit2.Call;&#10;import retrofit2.Callback;&#10;import retrofit2.Response;&#10;&#10;/**&#10; * HomeActivity displays a list of emails with functionalities like search, refresh, and compose.&#10; */&#10;public class HomeActivity extends AppCompatActivity implements&#10;        EmailAdapter.OnEmailClickListener,&#10;        NavigationView.OnNavigationItemSelectedListener {&#10;&#10;    private DrawerLayout drawerLayout;&#10;    private RecyclerView recyclerView;&#10;    private EmailAdapter adapter;&#10;    private SwipeRefreshLayout swipeRefreshLayout;&#10;    private final List&lt;EmailItem&gt; emailList = new ArrayList&lt;&gt;();&#10;    private TabLayout tabLayout;&#10;    private boolean isLoading = false;&#10;&#10;    @Override&#10;    protected void onCreate(Bundle savedInstanceState) {&#10;        super.onCreate(savedInstanceState);&#10;        setContentView(R.layout.activity_home);&#10;&#10;        // Setup toolbar&#10;        Toolbar toolbar = findViewById(R.id.toolbar);&#10;        setSupportActionBar(toolbar);&#10;        if (getSupportActionBar() != null) {&#10;            getSupportActionBar().setDisplayShowTitleEnabled(false);&#10;        }&#10;&#10;        // Setup navigation drawer&#10;        drawerLayout = findViewById(R.id.drawerLayout);&#10;        NavigationView navigationView = findViewById(R.id.navigationView);&#10;        navigationView.setNavigationItemSelectedListener(this);&#10;        ActionBarDrawerToggle toggle = new ActionBarDrawerToggle(&#10;                this, drawerLayout, toolbar, R.string.navigation_drawer_open, R.string.navigation_drawer_close);&#10;        drawerLayout.addDrawerListener(toggle);&#10;        toggle.syncState();&#10;&#10;        // Back gesture handling (closes drawer first)&#10;        getOnBackPressedDispatcher().addCallback(this, new OnBackPressedCallback(true) {&#10;            @Override public void handleOnBackPressed() {&#10;                if (drawerLayout.isDrawerOpen(GravityCompat.START)) {&#10;                    drawerLayout.closeDrawer(GravityCompat.START);&#10;                } else {&#10;                    setEnabled(false);&#10;                    getOnBackPressedDispatcher().onBackPressed();&#10;                }&#10;            }&#10;        });&#10;&#10;        // Setup tabs&#10;        tabLayout = findViewById(R.id.tabLayout);&#10;        tabLayout.addTab(tabLayout.newTab().setText(&quot;Primary&quot;));&#10;        tabLayout.addTab(tabLayout.newTab().setText(&quot;Social&quot;));&#10;        tabLayout.addTab(tabLayout.newTab().setText(&quot;Promotions&quot;));&#10;&#10;        // Setup RecyclerView&#10;        recyclerView = findViewById(R.id.recyclerViewEmails);&#10;        recyclerView.setLayoutManager(new LinearLayoutManager(this));&#10;&#10;        // Setup adapter&#10;        adapter = new EmailAdapter(emailList, this);&#10;        recyclerView.setAdapter(adapter);&#10;&#10;        // Setup SwipeRefreshLayout&#10;        swipeRefreshLayout = findViewById(R.id.swipeRefreshLayout);&#10;        swipeRefreshLayout.setColorSchemeResources(android.R.color.holo_blue_bright,&#10;                android.R.color.holo_green_light,&#10;                android.R.color.holo_orange_light,&#10;                android.R.color.holo_red_light);&#10;        swipeRefreshLayout.setOnRefreshListener(this::refreshEmails);&#10;&#10;        // Load emails from API&#10;        fetchEmailsFromApi();&#10;&#10;        // Setup swipe actions&#10;        setupSwipeActions();&#10;&#10;&#10;        // Setup FAB&#10;        FloatingActionButton fab = findViewById(R.id.fabCompose);&#10;        fab.setOnClickListener(v -&gt; {&#10;            Toast.makeText(this, &quot;Compose new email&quot;, Toast.LENGTH_SHORT).show();&#10;            // Launch compose activity&#10;        });&#10;&#10;        // Setup SearchView&#10;        SearchView searchView = findViewById(R.id.searchView);&#10;        searchView.setOnQueryTextListener(new SearchView.OnQueryTextListener() {&#10;            @Override&#10;            public boolean onQueryTextSubmit(String query) {&#10;                return false;&#10;            }&#10;&#10;            @Override&#10;            public boolean onQueryTextChange(String newText) {&#10;                adapter.getFilter().filter(newText);&#10;                return true;&#10;            }&#10;        });&#10;    }&#10;&#10;    /**&#10;     * Setup swipe actions for RecyclerView items (archive and delete).&#10;     */&#10;    private void setupSwipeActions() {&#10;        ItemTouchHelper.SimpleCallback callback = new ItemTouchHelper.SimpleCallback(0,&#10;                ItemTouchHelper.LEFT | ItemTouchHelper.RIGHT) {&#10;&#10;            @Override&#10;            public boolean onMove(@NonNull RecyclerView recyclerView,&#10;                                  @NonNull RecyclerView.ViewHolder viewHolder,&#10;                                  @NonNull RecyclerView.ViewHolder target) {&#10;                return false;&#10;            }&#10;&#10;            @Override&#10;            public void onSwiped(@NonNull RecyclerView.ViewHolder viewHolder, int direction) {&#10;                int position = viewHolder.getAdapterPosition();&#10;                EmailItem deletedEmail = emailList.get(position);&#10;&#10;                emailList.remove(position);&#10;                adapter.notifyItemRemoved(position);&#10;&#10;                String action = (direction == ItemTouchHelper.RIGHT) ? &quot;archived&quot; : &quot;deleted&quot;;&#10;&#10;                Snackbar.make(recyclerView, &quot;Email &quot; + action, Snackbar.LENGTH_LONG)&#10;                        .setAction(&quot;UNDO&quot;, v -&gt; {&#10;                            emailList.add(position, deletedEmail);&#10;                            adapter.notifyItemInserted(position);&#10;                        }).show();&#10;            }&#10;&#10;            @Override&#10;            public void onChildDraw(@NonNull Canvas c, @NonNull RecyclerView rv,&#10;                                    @NonNull RecyclerView.ViewHolder vh,&#10;                                    float dX, float dY, int actionState, boolean isCurrentlyActive) {&#10;                View itemView = vh.itemView;&#10;                Paint paint = new Paint();&#10;                if (dX &gt; 0) {&#10;                    paint.setColor(Color.parseColor(&quot;#2E7D32&quot;)); // green for archive&#10;                    c.drawRect(itemView.getLeft(), itemView.getTop(),&#10;                            itemView.getLeft() + dX, itemView.getBottom(), paint);&#10;                } else if (dX &lt; 0) {&#10;                    paint.setColor(Color.parseColor(&quot;#C62828&quot;)); // red for delete&#10;                    c.drawRect(itemView.getRight() + dX, itemView.getTop(),&#10;                            itemView.getRight(), itemView.getBottom(), paint);&#10;                }&#10;                super.onChildDraw(c, rv, vh, dX, dY, actionState, isCurrentlyActive);&#10;            }&#10;        };&#10;        new ItemTouchHelper(callback).attachToRecyclerView(recyclerView);&#10;    }&#10;&#10;    /**&#10;     * Handle navigation item selection.&#10;     */&#10;    @Override&#10;    public boolean onNavigationItemSelected(@NonNull MenuItem item) {&#10;        int id = item.getItemId();&#10;&#10;        // Handle navigation item clicks&#10;        if (id == R.id.nav_all_inboxes) {&#10;            Toast.makeText(this, &quot;All inboxes&quot;, Toast.LENGTH_SHORT).show();&#10;        } else if (id == R.id.nav_inbox) {&#10;            Toast.makeText(this, &quot;Inbox&quot;, Toast.LENGTH_SHORT).show();&#10;        } else if (id == R.id.nav_starred) {&#10;            Toast.makeText(this, &quot;Starred&quot;, Toast.LENGTH_SHORT).show();&#10;        } else if (id == R.id.nav_snoozed) {&#10;            Toast.makeText(this, &quot;Snoozed&quot;, Toast.LENGTH_SHORT).show();&#10;        } else if (id == R.id.nav_sent) {&#10;            Toast.makeText(this, &quot;Sent&quot;, Toast.LENGTH_SHORT).show();&#10;        }&#10;&#10;        drawerLayout.closeDrawer(GravityCompat.START);&#10;        return true;&#10;    }&#10;&#10;    /**&#10;     * Fetch emails from the API and update the RecyclerView.&#10;     */&#10;    private void fetchEmailsFromApi() {&#10;        if (isLoading) return;&#10;        isLoading = true;&#10;        // Show loading indicator&#10;        if (swipeRefreshLayout != null) {&#10;            swipeRefreshLayout.setEnabled(false);&#10;            swipeRefreshLayout.post(() -&gt; swipeRefreshLayout.setRefreshing(true));&#10;        }&#10;&#10;        EmailApiService apiService = ApiClient.getClient().create(EmailApiService.class);&#10;        Call&lt;List&lt;EmailData&gt;&gt; call = apiService.getMails();&#10;        call.enqueue(new Callback&lt;List&lt;EmailData&gt;&gt;() {&#10;            @Override&#10;            public void onResponse(Call&lt;List&lt;EmailData&gt;&gt; call, Response&lt;List&lt;EmailData&gt;&gt; response) {&#10;                finishLoading();&#10;                if (response.isSuccessful() &amp;&amp; response.body() != null) {&#10;                    List&lt;EmailItem&gt; items = new ArrayList&lt;&gt;();&#10;                    for (EmailData email : response.body()) {&#10;                        items.add(email.toEmailItem());&#10;                    }&#10;                    // Update UI&#10;                    adapter.setItems(items);&#10;                    if (items.isEmpty()) {&#10;                        showInfo(&quot;No emails yet&quot;);&#10;                    }&#10;                } else {&#10;                    String serverMsg = &quot;&quot;;&#10;                    try {&#10;                        if (response.errorBody() != null) {&#10;                            serverMsg = response.errorBody().string();&#10;                        }&#10;                    } catch (Exception ignored) {}&#10;                    if (response.code() == 401) {&#10;                        showErrorWithRetry(&quot;Session expired. Please log in again.&quot;);&#10;                        // Here you would redirect to login activity&#10;                        return;&#10;                    }&#10;                    String msg = serverMsg.isEmpty()&#10;                            ? &quot;Failed to load emails (&quot; + response.code() + &quot;)&quot;&#10;                            : &quot;Failed to load emails: &quot; + serverMsg;&#10;                    showErrorWithRetry(msg);&#10;                }&#10;            }&#10;&#10;            @Override&#10;            public void onFailure(Call&lt;List&lt;EmailData&gt;&gt; call, Throwable t) {&#10;                finishLoading();&#10;                showErrorWithRetry(&quot;Network error: &quot; + t.getMessage());&#10;            }&#10;        });&#10;    }&#10;&#10;    private void finishLoading() {&#10;        isLoading = false;&#10;        if (swipeRefreshLayout != null) {&#10;            swipeRefreshLayout.setRefreshing(false);&#10;            swipeRefreshLayout.setEnabled(true);&#10;        }&#10;    }&#10;&#10;    /**&#10;     * Show an informational &quot;Snackbar&quot; message.&#10;     */&#10;    private void showErrorWithRetry(String message) {&#10;        Snackbar.make(recyclerView, message, Snackbar.LENGTH_INDEFINITE)&#10;                .setAction(&quot;RETRY&quot;, v -&gt; fetchEmailsFromApi())&#10;                .show();&#10;    }&#10;&#10;    /**&#10;     * Show an informational &quot;Snackbar&quot; message.&#10;     */&#10;    private void showInfo(String message) {&#10;        Snackbar.make(recyclerView, message, Snackbar.LENGTH_SHORT).show();&#10;    }&#10;&#10;    /**&#10;     * When refresh is triggered, fetch emails from the API.&#10;     */&#10;    private void refreshEmails() {&#10;        fetchEmailsFromApi();&#10;    }&#10;&#10;    /**&#10;     * Handle email item click to mark as read and open detail view.&#10;     */&#10;    @Override&#10;    public void onEmailClick(int position) {&#10;        EmailItem email = adapter.getItem(position);&#10;        email.setRead(true);&#10;        adapter.notifyItemChanged(position);&#10;&#10;        // Here you would launch the email detail activity&#10;        Toast.makeText(this, &quot;Email from: &quot; + email.getSender(), Toast.LENGTH_SHORT).show();&#10;    }&#10;}" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/app/src/main/java/com/example/androidproject/ui/auth/LoginActivity.java">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/app/src/main/java/com/example/androidproject/ui/auth/LoginActivity.java" />
              <option name="originalContent" value="package com.example.androidproject.ui.auth;&#10;&#10;import android.content.Intent;&#10;import android.os.Bundle;&#10;import android.view.View;&#10;import android.widget.ProgressBar;&#10;import android.widget.Toast;&#10;&#10;import androidx.activity.EdgeToEdge;&#10;import androidx.appcompat.app.AppCompatActivity;&#10;&#10;import com.example.androidproject.ui.email.MailsActivity;&#10;import com.example.androidproject.R;&#10;import com.example.androidproject.util.TokenManager;&#10;import com.example.androidproject.util.ValidationUtils;&#10;import com.example.androidproject.data.remote.net.ApiClient;&#10;import com.example.androidproject.api.ApiService;&#10;import com.example.androidproject.model.LoginResponse;&#10;import com.google.android.material.button.MaterialButton;&#10;import com.google.android.material.textfield.TextInputEditText;&#10;import com.google.android.material.textfield.TextInputLayout;&#10;&#10;import java.io.IOException;&#10;import okhttp3.ResponseBody;&#10;import retrofit2.Call;&#10;import retrofit2.Callback;&#10;import retrofit2.Response;&#10;&#10;/**&#10; * LoginActivity handles user login functionality.&#10; * It validates user input, communicates with the backend API,&#10; * and navigates to the HomeActivity upon successful login.&#10; */&#10;public class LoginActivity extends AppCompatActivity {&#10;&#10;    private TextInputLayout tilUsername, tilPassword;&#10;    private TextInputEditText etUsername, etPassword;&#10;    private ProgressBar progressBar;&#10;&#10;    @Override&#10;    protected void onCreate(Bundle savedInstanceState) {&#10;        super.onCreate(savedInstanceState);&#10;        EdgeToEdge.enable(this);&#10;        setContentView(R.layout.activity_login);&#10;&#10;        // Initialize views&#10;        tilUsername = findViewById(R.id.til_email);&#10;        tilPassword = findViewById(R.id.til_login_password);&#10;        etUsername = findViewById(R.id.et_email);&#10;        etPassword = findViewById(R.id.et_login_password);&#10;        progressBar = findViewById(R.id.progress_bar);&#10;&#10;        // Set up button clicks&#10;        MaterialButton btnSignIn = findViewById(R.id.btn_sign_in);&#10;        MaterialButton btnCreateAccount = findViewById(R.id.btn_create_account);&#10;        MaterialButton btnForgotPassword = findViewById(R.id.btn_forgot_password);&#10;&#10;        btnSignIn.setOnClickListener(v -&gt; validateAndSignIn());&#10;        btnCreateAccount.setOnClickListener(v -&gt; navigateToRegistration());&#10;        btnForgotPassword.setOnClickListener(v -&gt; handleForgotPassword());&#10;    }&#10;&#10;    /**&#10;     * Validates user input and initiates the sign-in process if valid.&#10;     */&#10;    private void validateAndSignIn() {&#10;        // Clear previous errors&#10;        tilUsername.setError(null);&#10;        tilPassword.setError(null);&#10;&#10;        String username = etUsername.getText() == null ? &quot;&quot; : etUsername.getText().toString().trim();&#10;        String password = etPassword.getText() == null ? &quot;&quot; : etPassword.getText().toString();&#10;&#10;        boolean isValid = true;&#10;&#10;        if (username.isEmpty()) {&#10;            tilUsername.setError(&quot;Enter your username&quot;);&#10;            isValid = false;&#10;        } else if (!ValidationUtils.isValidUsername(username)) {&#10;            tilUsername.setError(&quot;Enter a valid username&quot;);&#10;            isValid = false;&#10;        }&#10;&#10;        if (password.isEmpty()) {&#10;            tilPassword.setError(&quot;Enter a password&quot;);&#10;            isValid = false;&#10;        }&#10;&#10;        if (isValid) {&#10;            performLogin(username, password);&#10;        }&#10;    }&#10;&#10;    /**&#10;     * Performs the login operation by calling the backend API.&#10;     * @param username The username entered by the user.&#10;     * @param password The password entered by the user.&#10;     */&#10;    private void performLogin (String username, String password) {&#10;        showLoading(true);&#10;        ApiService apiService = ApiClient.getClient().create(ApiService.class);&#10;        Call&lt;LoginResponse&gt; call = apiService.login(username, password);&#10;        call.enqueue(new Callback&lt;LoginResponse&gt;() {&#10;            @Override&#10;            public void onResponse(Call&lt;LoginResponse&gt; call, Response&lt;LoginResponse&gt; response) {&#10;                showLoading(false);&#10;                if (response.isSuccessful() &amp;&amp; response.body() != null) {&#10;                    Toast.makeText(LoginActivity.this,&#10;                            &quot;Login successful&quot;, Toast.LENGTH_SHORT).show();&#10;                    LoginResponse.User user = response.body().getUser();&#10;                    if (user != null) {&#10;                        TokenManager.saveUserInfo(&#10;                                LoginActivity.this,&#10;                                user.getUsername(),&#10;                                user.getFirstName(),&#10;                                user.getSurName(),&#10;                                user.getPicture()&#10;                        );&#10;                    }&#10;                    // Navigate to the Home activity&#10;                    ApiClient.initialize(getApplicationContext());&#10;                    Intent intent = new Intent(LoginActivity.this, MailsActivity.class);&#10;                    startActivity(intent);&#10;                    finish();&#10;                } else {&#10;                    String errorMsg = &quot;Login failed&quot;;&#10;                    if (response.errorBody() != null) {&#10;                        try {&#10;                            errorMsg = response.errorBody().string();&#10;                        } catch (IOException e) {&#10;                            e.printStackTrace();&#10;                        }&#10;                    }&#10;                    Toast.makeText(LoginActivity.this, errorMsg, Toast.LENGTH_LONG).show();&#10;                }&#10;            }&#10;            @Override&#10;            public void onFailure(Call&lt;LoginResponse&gt; call, Throwable t) {&#10;                showLoading(false);&#10;                Toast.makeText(LoginActivity.this,&#10;                        &quot;Network error: &quot; + t.getMessage(), Toast.LENGTH_LONG).show();&#10;            }&#10;        });&#10;    }&#10;&#10;&#10;    /**&#10;     * Navigates to the registration activity.&#10;     */&#10;    private void navigateToRegistration() {&#10;        Intent intent = new Intent(this, MainActivity.class);&#10;        startActivity(intent);&#10;    }&#10;&#10;    /**&#10;     * Handles the forgot password functionality.&#10;     * Currently, it shows a placeholder message.&#10;     */&#10;    private void handleForgotPassword() {&#10;        // TODO: Implement forgot password flow&#10;        Toast.makeText(this, &quot;Forgot password clicked&quot;, Toast.LENGTH_SHORT).show();&#10;    }&#10;&#10;    /**&#10;     * Parses the error message from the response body.&#10;     * @param errorBody The response body containing the error.&#10;     * @return The parsed error message.&#10;     */&#10;    private String parseError (ResponseBody errorBody) {&#10;        try {&#10;            return errorBody.string();&#10;        } catch (IOException e) {&#10;            e.printStackTrace();&#10;            return &quot;An Unknown error occurred&quot;;&#10;        }&#10;    }&#10;&#10;    /**&#10;     * Shows or hides the loading indicator.&#10;     * @param isLoading True to show the loading indicator, false to hide it.&#10;     */&#10;    private void showLoading(boolean isLoading) {&#10;        if (progressBar != null) {&#10;            progressBar.setVisibility(isLoading ? View.VISIBLE : View.GONE);&#10;        }&#10;    }&#10;}" />
              <option name="updatedContent" value="package com.example.androidproject.ui.auth;&#10;&#10;import android.content.Intent;&#10;import android.os.Bundle;&#10;import android.view.View;&#10;import android.widget.ProgressBar;&#10;import android.widget.Toast;&#10;&#10;import androidx.activity.EdgeToEdge;&#10;import androidx.appcompat.app.AppCompatActivity;&#10;&#10;import com.example.androidproject.ui.email.MailsActivity;&#10;import com.example.androidproject.R;&#10;import com.example.androidproject.util.TokenManager;&#10;import com.example.androidproject.util.ValidationUtils;&#10;import com.example.androidproject.data.remote.net.ApiClient;&#10;import com.example.androidproject.api.ApiService;&#10;import com.example.androidproject.model.LoginResponse;&#10;import com.google.android.material.button.MaterialButton;&#10;import com.google.android.material.textfield.TextInputEditText;&#10;import com.google.android.material.textfield.TextInputLayout;&#10;&#10;import java.io.IOException;&#10;import okhttp3.ResponseBody;&#10;import retrofit2.Call;&#10;import retrofit2.Callback;&#10;import retrofit2.Response;&#10;&#10;/**&#10; * LoginActivity handles user login functionality.&#10; * It validates user input, communicates with the backend API,&#10; * and navigates to the HomeActivity upon successful login.&#10; */&#10;public class LoginActivity extends AppCompatActivity {&#10;&#10;    private TextInputLayout tilUsername, tilPassword;&#10;    private TextInputEditText etUsername, etPassword;&#10;    private ProgressBar progressBar;&#10;&#10;    @Override&#10;    protected void onCreate(Bundle savedInstanceState) {&#10;        super.onCreate(savedInstanceState);&#10;        EdgeToEdge.enable(this);&#10;        setContentView(R.layout.activity_login);&#10;&#10;        // Initialize views&#10;        tilUsername = findViewById(R.id.til_email);&#10;        tilPassword = findViewById(R.id.til_login_password);&#10;        etUsername = findViewById(R.id.et_email);&#10;        etPassword = findViewById(R.id.et_login_password);&#10;        progressBar = findViewById(R.id.progress_bar);&#10;&#10;        // Set up button clicks&#10;        MaterialButton btnSignIn = findViewById(R.id.btn_sign_in);&#10;        MaterialButton btnCreateAccount = findViewById(R.id.btn_create_account);&#10;        MaterialButton btnForgotPassword = findViewById(R.id.btn_forgot_password);&#10;&#10;        btnSignIn.setOnClickListener(v -&gt; validateAndSignIn());&#10;        btnCreateAccount.setOnClickListener(v -&gt; navigateToRegistration());&#10;        btnForgotPassword.setOnClickListener(v -&gt; handleForgotPassword());&#10;    }&#10;&#10;    /**&#10;     * Validates user input and initiates the sign-in process if valid.&#10;     */&#10;    private void validateAndSignIn() {&#10;        // Clear previous errors&#10;        tilUsername.setError(null);&#10;        tilPassword.setError(null);&#10;&#10;        String username = etUsername.getText() == null ? &quot;&quot; : etUsername.getText().toString().trim();&#10;        String password = etPassword.getText() == null ? &quot;&quot; : etPassword.getText().toString();&#10;&#10;        boolean isValid = true;&#10;&#10;        if (username.isEmpty()) {&#10;            tilUsername.setError(&quot;Enter your username&quot;);&#10;            isValid = false;&#10;        } else if (!ValidationUtils.isValidUsername(username)) {&#10;            tilUsername.setError(&quot;Enter a valid username&quot;);&#10;            isValid = false;&#10;        }&#10;&#10;        if (password.isEmpty()) {&#10;            tilPassword.setError(&quot;Enter a password&quot;);&#10;            isValid = false;&#10;        }&#10;&#10;        if (isValid) {&#10;            performLogin(username, password);&#10;        }&#10;    }&#10;&#10;    /**&#10;     * Performs the login operation by calling the backend API.&#10;     * @param username The username entered by the user.&#10;     * @param password The password entered by the user.&#10;     */&#10;    private void performLogin (String username, String password) {&#10;        showLoading(true);&#10;        ApiService apiService = ApiClient.getClient().create(ApiService.class);&#10;        Call&lt;LoginResponse&gt; call = apiService.login(username, password);&#10;        call.enqueue(new Callback&lt;LoginResponse&gt;() {&#10;            @Override&#10;            public void onResponse(Call&lt;LoginResponse&gt; call, Response&lt;LoginResponse&gt; response) {&#10;                showLoading(false);&#10;                if (response.isSuccessful() &amp;&amp; response.body() != null) {&#10;                    Toast.makeText(LoginActivity.this,&#10;                            &quot;Login successful&quot;, Toast.LENGTH_SHORT).show();&#10;                    LoginResponse.User user = response.body().getUser();&#10;                    if (user != null) {&#10;                        TokenManager.saveUserInfo(&#10;                                LoginActivity.this,&#10;                                user.getUsername(),&#10;                                user.getFirstName(),&#10;                                user.getSurName(),&#10;                                user.getPicture()&#10;                        );&#10;                    }&#10;                    // Navigate to the Home activity&#10;                    ApiClient.initialize(getApplicationContext());&#10;                    Intent intent = new Intent(LoginActivity.this, MailsActivity.class);&#10;                    startActivity(intent);&#10;                    finish();&#10;                } else {&#10;                    String errorMsg = &quot;Login failed&quot;;&#10;                    if (response.errorBody() != null) {&#10;                        try {&#10;                            errorMsg = response.errorBody().string();&#10;                        } catch (IOException e) {&#10;                            e.printStackTrace();&#10;                        }&#10;                    }&#10;                    Toast.makeText(LoginActivity.this, errorMsg, Toast.LENGTH_LONG).show();&#10;                }&#10;            }&#10;            @Override&#10;            public void onFailure(Call&lt;LoginResponse&gt; call, Throwable t) {&#10;                showLoading(false);&#10;                Toast.makeText(LoginActivity.this,&#10;                        &quot;Network error: &quot; + t.getMessage(), Toast.LENGTH_LONG).show();&#10;            }&#10;        });&#10;    }&#10;&#10;&#10;    /**&#10;     * Navigates to the registration activity.&#10;     */&#10;    private void navigateToRegistration() {&#10;        Intent intent = new Intent(this, MainActivity.class);&#10;        startActivity(intent);&#10;    }&#10;&#10;    /**&#10;     * Handles the forgot password functionality.&#10;     * Currently, it shows a placeholder message.&#10;     */&#10;    private void handleForgotPassword() {&#10;        // TODO: Implement forgot password flow&#10;        Toast.makeText(this, &quot;Forgot password clicked&quot;, Toast.LENGTH_SHORT).show();&#10;    }&#10;&#10;    /**&#10;     * Parses the error message from the response body.&#10;     * @param errorBody The response body containing the error.&#10;     * @return The parsed error message.&#10;     */&#10;    private String parseError (ResponseBody errorBody) {&#10;        try {&#10;            return errorBody.string();&#10;        } catch (IOException e) {&#10;            e.printStackTrace();&#10;            return &quot;An Unknown error occurred&quot;;&#10;        }&#10;    }&#10;&#10;    /**&#10;     * Shows or hides the loading indicator.&#10;     * @param isLoading True to show the loading indicator, false to hide it.&#10;     */&#10;    private void showLoading(boolean isLoading) {&#10;        if (progressBar != null) {&#10;            progressBar.setVisibility(isLoading ? View.VISIBLE : View.GONE);&#10;        }&#10;    }&#10;}" />
            </PendingDiffInfo>
          </value>
        </entry>
      </map>
    </option>
  </component>
</project>